<html>
<head>
  <title>Waterpipe</title>

  <link rel="stylesheet" href="/style/page/process.css">

  <script src="https://unpkg.com/konva@8/konva.js"></script>
  <script src="/util/konva_commons.js"></script>

  <script src="/util/commons.js"></script>
  <script src="/page/process.js"></script>
</head>
<body>
<section id="ui">
  <article id="header">
    <h1 data-type="title">Waterpipe</h1>
    <waterpipe-server-health target="http://127.0.0.1:8000"></waterpipe-server-health>
    <h2 data-type="process-name"></h2>
    <button class="pill" data-type="process-version">Version: 1</button>
    <button class="pill green" data-type="save">Save</button>
  </article>
  <section id="notify">
  </section>
  <dialog id="select-addr-dialog">
    <h3>Specify server address</h3>
    <label for="server-addr-input">
    </label>
    <input id="server-addr-input" type="url" placeholder="url">
    <div class="container">
      <button class="pill" onclick="applyServer()">Apply</button>
    </div>
  </dialog>
  <dialog id="node-menu">
    <div class="header">
      <input data-type="node-title">
      <div><b>ID:</b><span class="mgw-lr-1" data-type="node-id"></span></div>
      <div><b>Type:</b><span class="mgw-lr-1" data-type="node-type"></span></div>
      <hr>
    </div>
    <div class="body">
    </div>
  </dialog>
  <dialog id="save-process">
    <h3>Save process with version</h3>
    <fieldset class="input">
      <legend>version</legend>
      <input type="number" min="1" data-type="process-version">
    </fieldset>
    <div class="container">
      <button class="pill" data-type="cancel">Cancel</button>
      <button class="pill green" data-type="save">Save</button>
    </div>
  </dialog>
  <dialog id="create-node" class="prompt">
    <div class="title">
      <h3>Select node type</h3>
    </div>
    <div class="payload">
      <fieldset class="input">
        <legend>type</legend>
        <input type="text" name="type" data-type="node-type" list="builtin-nodes">
        <datalist id="builtin-nodes">
          <option value="waterpipe.start">Processing starts from there</option>
          <option value="waterpipe.final">Processing stops there</option>
          <option value="waterpipe.code">JavaScript code</option>
          <option value="waterpipe.set">Set field</option>
          <option value="waterpipe.condition">Condition</option>
          <option value="waterpipe.goto">Jump to another process</option>
          <option value="waterpipe.create_task">Create child task</option>
          <option value="waterpipe.random">Generate pseudo-random number</option>
          <option value="waterpipe.api_call">API Call</option>
        </datalist>
      </fieldset>
    </div>
    <div class="submit">
      <input type="submit" class="pill" data-type="cancel" value="Cancel">
      <input type="submit" class="pill" data-type="apply" value="Apply">
    </div>
  </dialog>
  <dialog id="process-version-dialog">
    <fieldset class="input">
      <legend>version</legend>
      <input type="text" name="version" data-type="process-version">
    </fieldset>
    <button class="pill" data-type="apply">Apply</button>
    <div data-type="versions">
      <ul class="noorder selectable">
      </ul>
    </div>
  </dialog>
  <dialog id="process-selector">
    <fieldset class="input">
      <legend>process</legend>
      <input type="text" name="process_name" data-type="process-name">
      <input type="text" name="process_id" data-type="process-id" hidden>
    </fieldset>
    <div class="submit">
      <input type="submit" class="pill" data-type="cancel" value="Cancel">
      <input type="submit" class="pill" data-type="apply" value="Apply">
    </div>
    <div data-list="process"></div>
  </dialog>
</section>
<section id="editor"></section>
</body>
</html>